# מסמך דרישות - ניהול העברות לגזברים

## מבוא

תכונה זו מיועדת לאפשר לגזברים (מעגליים וקבוצתיים) לנהל את תהליך אישור וביצוע ההעברות של החזרים בצורה יעילה ומאורגנת. המערכת תאפשר צפייה, סינון, מיון, ואישור מרובה של החזרים, תוך הפרדה ברורה בין סטטוסים שונים.

**הערה:** קיים כבר דף "העברות" (Payments.tsx) במערכת שמציג רק החזרים מאושרים ומאפשר לסמן אותם כשולמו. תכונה זו תרחיב את הדף הקיים ותוסיף פונקציונליות מלאה לניהול כל סטטוסי ההחזרים.

## דרישות

### דרישה 1: עמוד ניהול העברות לגזברים

**User Story:** כגזבר (מעגלי או קבוצתי), אני רוצה עמוד ייעודי לניהול העברות, כדי שאוכל לראות ולנהל את כל ההחזרים הממתינים לאישור ושאושרו בצורה מסודרת.

#### קריטריוני קבלה

1. WHEN גזבר מעגלי ניגש לעמוד ההעברות THEN המערכת SHALL להציג את כל ההחזרים של כל התקציבים המעגליים
2. WHEN גזבר קבוצתי ניגש לעמוד ההעברות THEN המערכת SHALL להציג רק את ההחזרים של התקציבים של הקבוצות שלו
3. WHEN משתמש שאינו גזבר מנסה לגשת לעמוד ההעברות THEN המערכת SHALL למנוע גישה ולהציג הודעת שגיאה מתאימה
4. WHEN הגזבר נמצא בעמוד ההעברות THEN המערכת SHALL להציג ניווט ברור לעמוד זה בתפריט הראשי

### דרישה 2: סינון והצגת החזרים

**User Story:** כגזבר, אני רוצה לסנן את ההחזרים לפי קריטריונים שונים, כדי שאוכל למצוא במהירות את ההחזרים הרלוונטיים לטיפול.

#### קריטריוני קבלה

1. WHEN הגזבר בוחר "הצג לפי חברים" THEN המערכת SHALL לקבץ ולהציג את ההחזרים לפי משתמש
2. WHEN הגזבר בוחר "הצג לפי קופה" THEN המערכת SHALL לקבץ ולהציג את ההחזרים לפי קרן (fund)
3. WHEN הגזבר בוחר "הצג הכל" THEN המערכת SHALL להציג את כל ההחזרים ללא קיבוץ
4. WHEN הגזבר משנה את אופן ההצגה THEN המערכת SHALL לשמור את הבחירה ולהחיל אותה על כל הטבלאות

### דרישה 3: ארגון החזרים לפי סטטוס

**User Story:** כגזבר, אני רוצה לראות את ההחזרים מאורגנים לפי סטטוס, כדי שאוכל להתמקד בהחזרים שדורשים טיפול מיידי.

#### קריטריוני קבלה

1. WHEN הגזבר נמצא בעמוד ההעברות THEN המערכת SHALL להציג טבלה של החזרים ממתינים לאישור בראש הדף
2. WHEN הגזבר גולל למטה THEN המערכת SHALL להציג טבלה של החזרים לבדיקה מתחת לטבלת הממתינים
3. WHEN הגזבר ממשיך לגלול THEN המערכת SHALL להציג טבלה של החזרים שאושרו מתחת לטבלת הבדיקה
4. WHEN הגזבר גולל עד הסוף THEN המערכת SHALL להציג טבלה של החזרים שנדחו בתחתית הדף
5. WHEN טבלה מסוימת ריקה THEN המערכת SHALL להציג הודעה מתאימה "אין החזרים בסטטוס זה"

### דרישה 4: בחירה מרובה של החזרים

**User Story:** כגזבר, אני רוצה לבחור מספר החזרים בו זמנית, כדי שאוכל לאשר או להעביר אותם ביעילות.

#### קריטריוני קבלה

1. WHEN הגזבר לוחץ על checkbox ליד החזר THEN המערכת SHALL לסמן את ההחזר כנבחר
2. WHEN הגזבר לוחץ על "סמן הכל" THEN המערכת SHALL לסמן את כל ההחזרים בטבלה הנוכחית
3. WHEN הגזבר לוחץ שוב על "סמן הכל" AND כל ההחזרים מסומנים THEN המערכת SHALL לבטל את הסימון של כל ההחזרים
4. WHEN החזרים נבחרו THEN המערכת SHALL להציג מונה של מספר ההחזרים הנבחרים וסכום כולל
5. WHEN הגזבר משנה טבלה או סינון THEN המערכת SHALL לשמור את הבחירות הקיימות

### דרישה 5: אישור והעברת החזרים

**User Story:** כגזבר, אני רוצה לאשר החזרים בודדים או מרובים, כדי שאוכל לקדם את תהליך התשלום.

#### קריטריוני קבלה

1. WHEN הגזבר לוחץ על "אשר" ליד החזר בודד THEN המערכת SHALL לשנות את סטטוס ההחזר ל"אושר"
2. WHEN הגזבר בחר מספר החזרים AND לוחץ על "אשר נבחרים" THEN המערכת SHALL לשנות את סטטוס כל ההחזרים הנבחרים ל"אושר"
3. WHEN הגזבר לוחץ על "סמן כשולם" ליד החזר מאושר THEN המערכת SHALL לשנות את סטטוס ההחזר ל"שולם"
4. WHEN הגזבר בחר מספר החזרים מאושרים AND לוחץ על "סמן כשולם" THEN המערכת SHALL לשנות את סטטוס כל ההחזרים הנבחרים ל"שולם"
5. WHEN החזר משנה סטטוס THEN המערכת SHALL להעביר אותו לטבלה המתאימה ולהציג הודעת הצלחה

### דרישה 6: סימון החזר לבדיקה

**User Story:** כגזבר, אני רוצה לסמן החזר לבדיקה, כדי שאוכל לזכור שאני צריך לברר פרטים נוספים עם החבר לפני אישור.

#### קריטריוני קבלה

1. WHEN הגזבר לוחץ על "סמן לבדיקה" ליד החזר ממתין THEN המערכת SHALL לשנות את סטטוס ההחזר ל"לבדיקה"
2. WHEN הגזבר בחר מספר החזרים ממתינים AND לוחץ על "סמן לבדיקה" THEN המערכת SHALL לשנות את סטטוס כל ההחזרים הנבחרים ל"לבדיקה"
3. WHEN החזר מסומן לבדיקה THEN המערכת SHALL להעביר אותו לטבלת "לבדיקה"
4. WHEN הגזבר לוחץ על "החזר לממתין" ליד החזר בבדיקה THEN המערכת SHALL לשנות את סטטוס ההחזר בחזרה ל"ממתין לאישור"
5. WHEN החזר בסטטוס "לבדיקה" THEN המערכת SHALL לאפשר לגזבר להוסיף הערה או תזכורת

### דרישה 7: דחיית החזרים

**User Story:** כגזבר, אני רוצה לדחות החזרים שאינם מתאימים, כדי שהחבר יידע שההחזר לא אושר.

#### קריטריוני קבלה

1. WHEN הגזבר לוחץ על "דחה" ליד החזר THEN המערכת SHALL להציג דיאלוג לבקשת סיבת הדחייה
2. WHEN הגזבר מזין סיבת דחייה AND מאשר THEN המערכת SHALL לשנות את סטטוס ההחזר ל"נדחה" ולשמור את הסיבה
3. WHEN הגזבר בחר מספר החזרים AND לוחץ על "דחה נבחרים" THEN המערכת SHALL להציג דיאלוג לבקשת סיבת דחייה משותפת
4. WHEN החזר נדחה THEN המערכת SHALL להעביר אותו לטבלת "נדחו" ולהציג הודעת הצלחה
5. WHEN משתמש צופה בהחזר שלו שנדחה THEN המערכת SHALL להציג את סיבת הדחייה

### דרישה 8: מיון וסינון בטבלאות

**User Story:** כגזבר, אני רוצה למיין ולסנן את המידע בכל עמודה, כדי שאוכל למצוא במהירות את המידע שאני מחפש.

#### קריטריוני קבלה

1. WHEN הגזבר לוחץ על כותרת עמודה THEN המערכת SHALL למיין את הטבלה לפי אותה עמודה בסדר עולה
2. WHEN הגזבר לוחץ שוב על אותה כותרת עמודה THEN המערכת SHALL למיין בסדר יורד
3. WHEN הגזבר לוחץ על אייקון סינון בעמודה THEN המערכת SHALL להציג אפשרויות סינון רלוונטיות לסוג הנתונים
4. WHEN הגזבר מחיל סינון THEN המערכת SHALL להציג רק שורות שעומדות בקריטריון הסינון
5. WHEN הגזבר מחיל מספר סינונים THEN המערכת SHALL להחיל את כל הסינונים ביחד (AND logic)
6. WHEN הגזבר לוחץ על "נקה סינונים" THEN המערכת SHALL להסיר את כל הסינונים ולהציג את כל הנתונים

### דרישה 9: עמודות מידע בטבלאות

**User Story:** כגזבר, אני רוצה לראות מידע מפורט על כל החזר, כדי שאוכל לקבל החלטות מושכלות.

#### קריטריוני קבלה

1. WHEN הגזבר צופה בטבלת החזרים THEN המערכת SHALL להציג עמודות: checkbox, שם מגיש, שם מקבל תשלום, קרן, תיאור, סכום, תאריך, סטטוס, פעולות
2. WHEN החזר כולל מקבל תשלום שונה מהמגיש THEN המערכת SHALL להדגיש זאת בצורה ברורה
3. WHEN הגזבר מרחף מעל שם משתמש THEN המערכת SHALL להציג tooltip עם פרטים נוספים
4. WHEN הגזבר לוחץ על שורת החזר THEN המערכת SHALL להציג פרטים מלאים של ההחזר במודל או בפאנל צדדי
5. WHEN החזר כולל חיובים קשורים THEN המערכת SHALL להציג את הסכום נטו (החזר - חיובים)

### דרישה 10: ממשק בעברית

**User Story:** כמשתמש דובר עברית, אני רוצה שכל הממשק יהיה בעברית, כדי שאוכל להשתמש במערכת בנוחות.

#### קריטריוני קבלה

1. WHEN המערכת מציגה את עמוד ההעברות THEN כל הטקסטים, כפתורים, ותוויות SHALL להיות בעברית
2. WHEN המערכת מציגה הודעות שגיאה או הצלחה THEN ההודעות SHALL להיות בעברית
3. WHEN המערכת מציגה סטטוסים THEN הסטטוסים SHALL להיות בעברית (ממתין לאישור, לבדיקה, אושר, נדחה, שולם)
4. WHEN המערכת מציגה תאריכים THEN התאריכים SHALL להיות בפורמט DD/MM/YY
